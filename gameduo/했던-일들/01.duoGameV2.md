# DuoGameV2 (Start kit) 프로젝트

## 목표

게임서버를 만들 때마다 공통되는 부분들을 모듈화하는 레포지토리. 추후 모든 게임은 이 모듈로부터 fork하여 시작함.

## 기대 가능한 결과

* 자사 게임들을 하나로 연결해주고, 게임 운영에 필요한 다양한 기능을 통합적으로 제공
* 조직 내 게임 서버 아키텍처를 통합함으로써 협업효율, 코드 완성도 증대
* 클라이언트 개발 및 운영팀에게 일관적인 운영 인터페이스 제공
* 기존 npm duogame 모듈, 독립적으로 제작했던 서버들이 가졌던 문제들 보완


## 기간

01/03 ~ 01/13

## 느낀점

입사 하자마자 받은 프로젝트가 비중이 꽤나 높은 프로젝트여서 부담이 되었다. 현 회사에서 서버 개발자는 4명 밖에 없고 각 개발자들이 게임 하나씩 맡고 있는 상황이라 코드리뷰를 할 수 있는 상황도 아니다.

스타트업의 효율성과 기술부채의 간극을 정말 아슬아슬하게 잡고있는 회사인 듯했다. 대표 게임으로는 닌자대전, 서머너즈클랜, 아처 키우기, 매드탱크, 벽부수기2 등이 있다. 사실 어제 프로젝트를 거의 일단락 짓고 오늘(01/13) 서머너즈클랜 서버코드를 인수인계 받았는데 확실히 Node기반 서버가 소위 '네카라쿠배' 회사에서 사용하지 않는 이유를 어느정도 직감하였다. 사실 노드 개발자로서 그런 단점을 들을 때 기분이 좋지만은 않다. 하지만 node 탄생의 철학은 '가볍고', '자유로움'이기에 어쩔수 없이 동의하게 되는 것 같다.

node, express, redis, nginx 기반으로 자유롭게 개발되어있는 코드였다. 안타까운 것은 기본적인 노드 아키텍처인 router, controller 디렉토리로 나눠져있지도 않았고, 모든 비즈니스 로직은 라우터와, 컨트롤러에 나뉘어져 있었다. 그리고 ORM을 사용하지 않았고 mysql db pool을 생성한 다음에 `Raw query`를 날리는 구조였기에 단 하나의 오타여도 컴파일러가 잡아주지 못했다. 또한 query의 result를 포함한 대부분의 타입들은 `any`로 되어있었고(anyScript..) Presentation layer에서 `DTO 검증`도 되어있지 않았어서 클라이언트가 약속된 데이터를 보내지 않으면 500 에러가 나기 일쑤였다. Nest, TypeORM, TypeScript를 기반으로 편하게 개발했던 내가 마치 손발이 묶인 느낌이었다. 코드 처음보고 가슴이 답답해지는 동시에 뜨거워졌는데 기회라고 받아들이기로 했다.

물론 DuoGameV2는 Nest 프레임워크 덕에 Layered 아키텍쳐로 구성했고 Interface layer에 DTO 검증은 물론 모든 쿼리의 결과값은 TypeORM이 제공해주는 Entity 덕분에 Type을 전부 지정해주어 대부분의 에러를 컴파일타임에 잡을 수 있었다. 앞으로의 게임들이라도 Nest 기반으로 ```정형화된``` 아키텍쳐로 개발될 수 있으므로 나름 1주일 동안 잠 안자고 개발한 뿌듯함은 느끼고 있다. 이번주에 새로운 게임을 출시한다. '우가우가'라는 게임인데 아직은 기본적인 서버 API만 필요한 단계여서 DuoGameV2 Start kit를 웹서버로 사용하기로 했다. 내가 개발했던 API는 우편함 서비스(쿠폰이랑 비슷함), 결제 서비스에서 영수증 검증, 결제에 대한 보상을 해주고 우편함으로 보상보내기 정도였다. 게임 개발이 생각보다 웹서버 개발이랑 크게 다르진 않는 것 같다. 

앞에서 많이 깐(?)것 같은데, 그래도 게임듀오에서 일하는 게 재밌고 크게 성장할 수 있는 기회를 마음껏 제공해주는 회사에 온 것 같아 크게 만족하고 있다