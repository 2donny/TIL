# 서머너즈클랜 어드민 페이지 개발

## 링크
https://summonersclan-admin.gameduo.net/

## 기간
01/16 ~ 01/24

## 동기
기존에 서머너즈클랜 어드민 페이지는 클라는 React.js, 서버는 Node.js로 개발되어있었다. 근데 어드민 API 기능을 추가할 때마다 클라/서버 두 번 배포를 해야했는데 이 리소스가 커서 서버사이드 렌더링이 가능한 Next.js로 마이그레이션을 하게되었는데 기존에 정적 블로그를 next.js로 개발한 경험이 있어서 큰 어려움 없이 어드민 기능을 복구할 수 있었다. 

## 문제 발생
가장 골치 아팠던 이슈는 Next.js는 한 프로젝트 안에 클라이언트 번들과 서버 번들을 2번 생성한다. 근데 실수로 컴포넌트 레이어에서 import한 파일 안에 redis 파일을 import 해버려서 ```Cannot resolve 'dns', 'fs'``` 이러한 에러가 났다. 그래도 금방 디버깅해서 sequelize로 mysql pool을 생성하거나 직접적으로 Query를 실행하는 코드들은 전부 ```servers/utils.ts``` 파일로 분리했다. 왜냐하면 redis를 컴파일하면서 그것과 종속적인 모듈들인 ```fs, dns, dgram```과 같은 것들은 클라이언트 즉, 브라우저에서 실행되지 않는 파일들이기 때문이다.  Next.js는 빌드시에 next.config.js 파일을 2번 실행하는 것도 알게되었고 컴포넌트 레이어와, 서버 레이어를 명확히 분리해야함을 배웠다.
